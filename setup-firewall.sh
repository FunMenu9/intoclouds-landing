#!/bin/bash

echo "üî• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–π—Ä–≤–æ–ª–∞ Azure VM"
echo "=============================="

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW..."
sudo apt install ufw -y

# –°–±—Ä–æ—Å –ø—Ä–∞–≤–∏–ª UFW
echo "üîÑ –°–±—Ä–æ—Å –ø—Ä–∞–≤–∏–ª UFW..."
sudo ufw --force reset

# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ SSH (–≤–∞–∂–Ω–æ!)
echo "üîë –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ SSH..."
sudo ufw allow ssh
sudo ufw allow 22

# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ HTTP –∏ HTTPS
echo "üåê –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ HTTP/HTTPS..."
sudo ufw allow 80
sudo ufw allow 443

# –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
echo "üîß –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏..."
sudo ufw allow 3000  # Next.js
sudo ufw allow 1337  # Strapi

# –í–∫–ª—é—á–µ–Ω–∏–µ UFW
echo "üî• –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π—Ä–≤–æ–ª–∞..."
sudo ufw --force enable

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
echo "üìä –°—Ç–∞—Ç—É—Å —Ñ–∞–π—Ä–≤–æ–ª–∞:"
sudo ufw status verbose

echo "‚úÖ –§–∞–π—Ä–≤–æ–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω!"
echo ""
echo "üìã –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã:"
echo "- 22 (SSH)"
echo "- 80 (HTTP)"
echo "- 443 (HTTPS)"
echo "- 3000 (Next.js - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)"
echo "- 1337 (Strapi - –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)"
